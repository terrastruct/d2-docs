---
sidebar_label: Dagre
# This file is autogenerated. Do not edit.
# See ci/examples/examples.sh for generation.
---

import ExampleGrid from '@site/src/components/ExampleGrid';

# D2 examples: Dagre layout

See [/tour/dagre](/tour/dagre).

<ExampleGrid examples={[
  {
    name: 'Bank Securities',
    svgContent: require('@site/static/img/examples/example-bank-securities-dagre.svg2'),
    code: "bank:   {\n  style.fill: white\n  Corporate:   {\n    style.fill: white\n    app14506: Data Source\\ntco:      100,000\\nowner: Lakshmi  {\n      style:  {\n        fill: '#fce7c6'\n      }\n    }\n  }\n  Equities:   {\n    app14491: Risk Global\\ntco:      600,000\\nowner: Wendy  {\n      style:  {\n        fill: '#f6c889'\n      }\n    }\n    app14492: Credit guard\\ntco:      100,000\\nowner: Lakshmi  {\n      style:  {\n        fill: '#fce7c6'\n      }\n    }\n    app14520: Seven heaven\\ntco:      100,000\\nowner: Tomos  {\n      style:  {\n        fill: '#fce7c6'\n      }\n    }\n    app14522: Apac Ace\\ntco:      400,000\\nowner: Wendy  {\n      style:  {\n        fill: '#f9d8a7'\n      }\n    }\n    app14527: Risk Global\\ntco:      900,000\\nowner: Tomos  {\n      style:  {\n        fill: '#f4b76c'\n      }\n    }\n  }\n  Securities:   {\n    style.fill: white\n    app14517: Zone out\\ntco:      500,000\\nowner: Wendy  {\n      style:  {\n        fill: '#f6c889'\n      }\n    }\n  }\n  Finance:   {\n    style.fill: white\n    app14488: Credit guard\\ntco:      700,000\\nowner: India  {\n      style:  {\n        fill: '#f6c889'\n      }\n    }\n    app14502: Ark Crypto\\ntco:    1,500,000\\nowner: Wendy  {\n      style:  {\n        fill: '#ed800c'\n      }\n    }\n    app14510: Data Solar\\ntco:    1,200,000\\nowner: Deepak  {\n      style:  {\n        fill: '#f1a64f'\n      }\n    }\n  }\n  Risk:   {\n    style.fill: white\n    app14490: Seven heaven\\ntco:            0\\nowner: Joesph  {\n      style:  {\n        fill: '#fce7c6'\n      }\n    }\n    app14507: Crypto Bot\\ntco:    1,100,000\\nowner: Wendy  {\n      style:  {\n        fill: '#f1a64f'\n      }\n    }\n  }\n  Funds:   {\n    style.fill: white\n    app14497: Risk Global\\ntco:      500,000\\nowner: Joesph  {\n      style:  {\n        fill: '#f6c889'\n      }\n    }\n  }\n  Fixed Income:   {\n    style.fill: white\n    app14523: ARC3\\ntco:      600,000\\nowner: Wendy  {\n      style:  {\n        fill: '#f6c889'\n      }\n    }\n    app14500: Acmaze\\ntco:      100,000\\nowner: Tomos  {\n      style:  {\n        fill: '#fce7c6'\n      }\n    }\n  }\n}\nbank.Risk.app14490 -> bank.Equities.app14527: client master\nbank.Equities.app14491 -> bank.Equities.app14527: greeks  {\n  style:  {\n    stroke-dash: 5\n    animated: true\n    stroke: red\n  }\n}\nbank.Funds.app14497 -> bank.Equities.app14520: allocations  {\n  style:  {\n    stroke-dash: 5\n    animated: true\n    stroke: brown\n  }\n}\nbank.Equities.app14527 -> bank.Corporate.app14506: trades  {\n  style:  {\n    stroke-dash: 5\n    animated: false\n    stroke: blue\n  }\n}\nbank.Fixed Income.app14523 -> bank.Equities.app14491: orders  {\n  style:  {\n    stroke-dash: 10\n    animated: false\n    stroke: green\n  }\n}\nbank.Finance.app14488 -> bank.Equities.app14527: greeks  {\n  style:  {\n    stroke-dash: 5\n    animated: true\n    stroke: red\n  }\n}\nbank.Equities.app14527 -> bank.Equities.app14522: orders  {\n  style:  {\n    stroke-dash: 10\n    animated: false\n    stroke: green\n  }\n}\nbank.Equities.app14522 -> bank.Finance.app14510: orders  {\n  style:  {\n    stroke-dash: 10\n    animated: false\n    stroke: green\n  }\n}\nbank.Equities.app14527 -> bank.Finance.app14502: greeks  {\n  style:  {\n    stroke-dash: 5\n    animated: true\n    stroke: red\n  }\n}\nbank.Equities.app14527 -> bank.Risk.app14507: allocations  {\n  style:  {\n    stroke-dash: 5\n    animated: true\n    stroke: brown\n  }\n}\nbank.Securities.app14517 -> bank.Equities.app14492: trades  {\n  style:  {\n    stroke-dash: 5\n    animated: false\n    stroke: blue\n  }\n}\nbank.Equities.app14522 -> bank.Fixed Income.app14500: security reference"
  },
  {
    name: 'Udp Tunnel',
    svgContent: require('@site/static/img/examples/example-udp-tunnel-dagre.svg2'),
    code: "shape: sequence_diagram\n\nbackend_server\nlocal_server\nssh_server\nother_server\n\n启动阶段: {\n    local_server->ssh_server:ssh_login\n    local_server<-ssh_server:ssh 登录成功\n    local_server->ssh_server:sftp_copy 辅助转发服务器\n    local_server->ssh_server:ssh  启动转发服务器\n}\n\n启动成功运行阶段:{\n\n        other_server->ssh_server.a:请求udp packet{\n            style.animated: true\n            style.stroke: red\n        }\n\n        ssh_server.a->local_server.a:udp forward 发送给 udp client {\n            style.animated: true\n            style.stroke: red\n        }\n\n        local_server.a->backend_server.a: \"udp 转发给 udp server\"{\n            style.animated: true\n            style.stroke: red\n        }\n\n        backend_server.b->local_server.b:发送ok字符串给 udp的请求端{\n            style.animated: true\n            style.stroke: green\n        }\n\n        ssh_server.b<-local_server.b: 发送给 ssh 所在的 udp forawrd {\n            style.animated: true\n            style.stroke: green\n        }\n\n        other_server<-ssh_server.b:返回udp 请求回复{\n            style.animated: true\n            style.stroke:green\n        }\n        other_server.一次交互完成\n\n}"
  },
  {
    name: 'Llm Framework Architecture',
    svgContent: require('@site/static/img/examples/example-llm-framework-architecture-dagre.svg2'),
    code: "vars: {\n  d2-config: {\n    theme-id: 3 # terrastruct\n    sketch: true\n    layout-engine: elk\n  }\n  colors: {\n    c2: \"#C7F1FF\" # light turkuaz\n    c3: \"#B5AFF6\" # dark purple\n    c4: \"#DEE1EB\" # gray\n    c5: \"#88DCF7\" # turkuaz\n    c6: \"#E4DBFE\" # purple\n  }\n}\n\nLangUnits: {\n  style.fill: ${colors.c6}\n  RegexVal: {\n    ds\n  }\n  SQLSelect: {\n    ds\n  }\n  PythonTr: {\n    ds\n  }\n  langunit ₙ: {\n    style.multiple: true\n    style.stroke-dash: 10\n    style.stroke: black\n    style.animated: 1\n    \"... ds\"\n  }\n}\n\nLangUnits <- ExperimentHost.Dataset: \"load dataset\"\nDataset UI -> LangUnits: \"manage datasets\"\n\nDataset UI: {\n  style.fill: ${colors.c4}\n}\n\nExperimentHost: {\n  style.fill: ${colors.c4}\n  Experiment: {\n    style.multiple: true\n  }\n  Dataset\n  # Experiment <-> Dataset\n}\nExperimentHost.Experiment -> Experiment\n\nExperiment.ModelConfigurations: {\n  style.multiple: true\n}\nExperiment.LangUnit\n\nExperiment.ModelConfigurations -> ModelConfiguration\n\nModelConfiguration.Prompting\nModelConfiguration.Model\nModelConfiguration.LangUnit"
  },
  {
    name: 'Terraform Resources',
    svgContent: require('@site/static/img/examples/example-terraform-resources-dagre.svg2'),
    code: "vars: {\n  d2-config: {\n    layout-engine: elk\n  }\n}\n\n*.style.font-size: 22\n*.*.style.font-size: 22\n\ntitle: |md\n  # Terraform resources (v1.0.0)\n| {near: top-center}\n\ndirection: right\n\nproject_connection: {\n  style: {\n    fill: \"#C5C6C7\"\n    stroke: grey\n  }\n}\n\nprivatelink_endpoint: {tooltip: Datasource only}\ngroup\ngroup_partial_permissions\nservice_token\njob: {\n  style: {\n    fill: \"#ACE1AF\"\n    stroke: green\n  }\n}\n\nconns: Connections (will be removed in the future,\\nuse global_connection) {\n  bigquery_connection\n  fabric_connection\n  connection\n\n  bigquery_connection.style.fill: \"#C5C6C7\"\n  fabric_connection.style.fill: \"#C5C6C7\"\n  connection.style.fill: \"#C5C6C7\"\n}\nconns.style.fill: \"#C5C6C7\"\n\nenv_creds: Environment Credentials {\n  grid-columns: 2\n  athena_credential\n  databricks_credential\n  snowflake_credential\n  bigquery_credential\n  fabric_credential\n  postgres_credential: {tooltip: Is used for Redshift as well}\n  teradata_credential\n}\n\nservice_token -- project: can scope to {\n  style: {\n    stroke-dash: 3\n  }\n}\ngroup -- project\ngroup_partial_permissions -- project\nuser_groups -- group\nuser_groups -- group_partial_permissions\nproject -- environment\nproject -- snowflake_semantic_layer_credential\njob -- environment\njob -- environment_variable_job_override\nnotification -- job\npartial_notification -- job\n\nwebhook -- job: triggered by {\n  style: {\n    stroke-dash: 3\n  }\n}\nenvironment -- global_connection\nenvironment -- conns\nglobal_connection -- privatelink_endpoint\nglobal_connection -- oauth_configuration\n\nenvironment -- env_creds\nconns -- privatelink_endpoint\nproject -- project_repository\nlineage_integration -- project\nproject_repository -- repository\nenvironment -- environment_variable\nenvironment -- partial_environment_variable\nenvironment -- extended_attributes\nenvironment -- semantic_layer_configuration\nmodel_notifications -- environment\n\nproject -- project_connection {\n  style: {\n    stroke: \"#C5C6C7\"\n  }\n}\nproject_connection -- conns {\n  style: {\n    stroke: \"#C5C6C7\"\n  }\n}\n\n(job -- *)[*].style.stroke: green\n(* -- job)[*].style.stroke: green\n\naccount_level_settings: \"Account level settings\" {\n  account_features\n  ip_restrictions_rule\n  license_map\n  partial_license_map\n}\naccount_level_settings.style.fill-pattern: dots"
  },
  {
    name: 'Game State Sequence',
    svgContent: require('@site/static/img/examples/example-game-state-sequence-dagre.svg2'),
    code: "shape: sequence_diagram\n\nUser\nSession\nLua\n\nUser.\"Init\"\n\nUser.t1 -> Session.t1: \"SetupFight()\"\nSession.t1 -> Session.t1: \"Create clean fight state\"\nSession.t1 -> Lua: \"Trigger OnPlayerTurn\"\nUser.t1 <- Session.t1\n\nUser.\"Repeat\"\n\nUser.mid -> Session.mid: \"PlayerCastHand() etc.\"\nSession.mid -> Lua: \"Trigger OnDamage etc.\"\nUser.mid <- Session.mid\n\nUser.t2 -> Session.t2: \"FinishPlayerTurn()\"\nSession.t2 -> Lua: \"Trigger OnTurn\"\nSession.t2 -> Session.t2: \"Update and remove status effects\"\nSession.t2 -> Lua: \"Trigger OnPlayerTurn\"\nUser.t2 <- Session.t2"
  },
  {
    name: 'Golang Queue',
    svgContent: require('@site/static/img/examples/example-golang-queue-dagre.svg2'),
    code: "direction: right\n\nclasses: {\n  base: {\n    style: {\n      bold: true\n      font-size: 28\n    }\n  }\n\n  person: {\n    shape: person\n  }\n\n  animated: {\n    style: {\n      animated: true\n    }\n  }\n\n  multiple: {\n    style: {\n      multiple: true\n    }\n  }\n\n  enqueue: {\n    label: Enqueue Task\n  }\n\n  dispatch: {\n    label: Dispatch Task\n  }\n\n  library: {\n    style: {\n      bold: true\n      font-size: 32\n      fill: PapayaWhip\n      fill-pattern: grain\n      border-radius: 8\n      font: mono\n    }\n  }\n\n  task: {\n    style: {\n      bold: true\n      font-size: 32\n    }\n  }\n}\n\nuser01: {\n  label: User01\n  class: [base; person; multiple]\n}\n\nuser02: {\n  label: User02\n  class: [base; person; multiple]\n}\n\nuser03: {\n  label: User03\n  class: [base; person; multiple]\n}\n\nuser01 -> container.task01: {\n  label: Create Task\n  class: [base; animated]\n}\nuser02 -> container.task02: {\n  label: Create Task\n  class: [base; animated]\n}\nuser03 -> container.task03: {\n  label: Create Task\n  class: [base; animated]\n}\n\ncontainer: Application {\n  direction: right\n  style: {\n    bold: true\n    font-size: 28\n  }\n  icon: https://icons.terrastruct.com/dev%2Fgo.svg\n\n  task01: {\n    icon: https://icons.terrastruct.com/essentials%2F092-graph%20bar.svg\n    class: [task; multiple]\n  }\n\n  task02: {\n    icon: https://icons.terrastruct.com/essentials%2F095-download.svg\n    class: [task; multiple]\n  }\n\n  task03: {\n    icon: https://icons.terrastruct.com/essentials%2F195-attachment.svg\n    class: [task; multiple]\n  }\n\n  queue: {\n    label: Queue Library\n    icon: https://icons.terrastruct.com/dev%2Fgo.svg\n    style: {\n      bold: true\n      font-size: 32\n      fill: honeydew\n    }\n\n    producer: {\n      label: Producer\n      class: library\n    }\n\n    consumer: {\n      label: Consumer\n      class: library\n    }\n\n    database: {\n      label: Ring\\nBuffer\n      shape: cylinder\n      style: {\n        bold: true\n        font-size: 32\n        fill-pattern: lines\n        font: mono\n      }\n    }\n\n    producer -> database\n    database -> consumer\n  }\n\n  worker01: {\n    icon: https://icons.terrastruct.com/essentials%2F092-graph%20bar.svg\n    class: [task]\n  }\n\n  worker02: {\n    icon: https://icons.terrastruct.com/essentials%2F095-download.svg\n    class: [task]\n  }\n\n  worker03: {\n    icon: https://icons.terrastruct.com/essentials%2F092-graph%20bar.svg\n    class: [task]\n  }\n\n  worker04: {\n    icon: https://icons.terrastruct.com/essentials%2F195-attachment.svg\n    class: [task]\n  }\n\n  task01 -> queue.producer: {\n    class: [base; enqueue]\n  }\n  task02 -> queue.producer: {\n    class: [base; enqueue]\n  }\n  task03 -> queue.producer: {\n    class: [base; enqueue]\n  }\n  queue.consumer -> worker01: {\n    class: [base; dispatch]\n  }\n  queue.consumer -> worker02: {\n    class: [base; dispatch]\n  }\n  queue.consumer -> worker03: {\n    class: [base; dispatch]\n  }\n  queue.consumer -> worker04: {\n    class: [base; dispatch]\n  }\n}"
  },
  {
    name: 'Lambda Infra',
    svgContent: require('@site/static/img/examples/example-lambda-infra-dagre.svg2'),
    code: "direction: right\n\ngithub: GitHub {\n  shape: image\n  icon: https://icons.terrastruct.com/dev%2Fgithub.svg\n  style: {\n    font-color: green\n    font-size: 30\n  }\n}\n\ngithub_actions: GitHub Actions {\n  lambda_action: Lambda Action {\n    icon: https://icons.terrastruct.com/dev%2Fgithub.svg\n    style.multiple: true\n  }\n  style: {\n    stroke: blue\n    font-color: purple\n    stroke-dash: 3\n    fill: white\n  }\n}\n\naws: AWS Cloud VPC {\n  style: {\n    font-color: purple\n    fill: white\n    opacity: 0.5\n  }\n  lambda01: Lambda01 {\n    icon: https://icons.terrastruct.com/aws%2FCompute%2FAWS-Lambda.svg\n    shape: parallelogram\n    style.fill: \"#B6DDF6\"\n  }\n  lambda02: Lambda02 {\n    icon: https://icons.terrastruct.com/aws%2FCompute%2FAWS-Lambda.svg\n    shape: parallelogram\n    style.fill: \"#B6DDF6\"\n  }\n  lambda03: Lambda03 {\n    icon: https://icons.terrastruct.com/aws%2FCompute%2FAWS-Lambda.svg\n    shape: parallelogram\n    style.fill: \"#B6DDF6\"\n  }\n}\n\ngithub -> github_actions: GitHub Action Flow {\n  style: {\n    animated: true\n    font-size: 20\n  }\n}\ngithub_actions -> aws.lambda01: Update Lambda {\n  style: {\n    animated: true\n    font-size: 20\n  }\n}\ngithub_actions -> aws.lambda02: Update Lambda {\n  style: {\n    animated: true\n    font-size: 20\n  }\n}\ngithub_actions -> aws.lambda03: Update Lambda {\n  style: {\n    animated: true\n    font-size: 20\n  }\n}\n\nexplanation: |md\n  ```yaml\n  deploy_source:\n    name: deploy lambda from source\n    runs-on: ubuntu-latest\n    steps:\n      - name: checkout source code\n        uses: actions/checkout@v3\n      - name: default deploy\n        uses: appleboy/lambda-action@v0.1.7\n        with:\n          aws_access_key_id: ${{ secrets.AWS_ACCESS_KEY_ID }}\n          aws_secret_access_key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}\n          aws_region: ${{ secrets.AWS_REGION }}\n          function_name: gorush\n          source: example/index.js\n  ```\n| {near: bottom-center}"
  },
]} layout="dagre" />
