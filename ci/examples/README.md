# D2 Examples Generator

This directory contains the tooling for generating the D2 example pages.

## Files

- `examples.sh` - Main script that generates example SVGs and documentation pages
- `examples.txtar` - Contains all D2 example code in [txtar format](https://pkg.go.dev/golang.org/x/tools/txtar)
- `README.md` - This documentation file

## How it works

The examples system works by:

1. **Parsing the txtar file**: The script reads `examples.txtar` which contains D2 code examples

2. **Extracting D2 files**: Each example is extracted to a temporary directory as individual `.d2` files

3. **Generating SVGs**: For each D2 file, the script generates SVG outputs using the D2 CLI with different layout engines

4. **Creating documentation pages**: The script generates three markdown files in `docs/examples/`:
   - `dagre.md`
   - `elk.md`
   - `tala.md`

## Layout engine detection

Examples can be targeted to specific layout engines by suffixing the filename:

- `example-name` - Generates for all three layout engines
- `example-name-dagre` - Only generates for Dagre layout
- `example-name-elk` - Only generates for ELK layout
- `example-name-tala` - Only generates for TALA layout

## Generated files

- SVG files are saved to `static/img/examples/`
- Documentation pages are saved to `docs/examples/`
- All generated files include comments indicating they're autogenerated

## Running the script

From the project root:

```bash
ci/examples/examples.sh
```

The script uses the CI framework and supports job filtering and parallel execution.

## Adding new examples

To add a new example:

1. Edit `examples.txtar`
2. Add a new section to the top with the format:
   ```
   -- example-name --
   a -> b
   ```
3. Run the script to regenerate files
